ARM GAS  /tmp/cc4TUbDM.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"mpu6050.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Module/imu/mpu6050.c"
  20              		.section	.text.MPU_Write_Len,"ax",%progbits
  21              		.align	1
  22              		.global	MPU_Write_Len
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	MPU_Write_Len:
  28              	.LVL0:
  29              	.LFB143:
   1:Module/imu/mpu6050.c **** #include "mpu6050.h" 
   2:Module/imu/mpu6050.c **** #include "alldata.h"
   3:Module/imu/mpu6050.c **** #include "kalman.h"
   4:Module/imu/mpu6050.c **** #include "stdio.h"
   5:Module/imu/mpu6050.c **** #include "i2c.h"
   6:Module/imu/mpu6050.c **** 
   7:Module/imu/mpu6050.c **** static volatile int16_t *pMpu = (int16_t *)&MPU6050;
   8:Module/imu/mpu6050.c **** int16_t MpuOffset[6] = {0};		//MPU6050补偿数值
   9:Module/imu/mpu6050.c **** 
  10:Module/imu/mpu6050.c **** //初始化MPU6050
  11:Module/imu/mpu6050.c **** //返回值:0,成功
  12:Module/imu/mpu6050.c **** //    其他,错误代码
  13:Module/imu/mpu6050.c **** uint8_t MPU_Init(void)
  14:Module/imu/mpu6050.c **** { 
  15:Module/imu/mpu6050.c ****   uint8_t res;
  16:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
  17:Module/imu/mpu6050.c ****   HAL_I2C_Init(&hi2c1);
  18:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_PWR_MGMT1_REG,0X80);	//复位MPU6050
  19:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_PWR_MGMT1_REG,0X00);	//唤醒MPU6050 
  20:Module/imu/mpu6050.c ****   MPU_Set_Gyro_Fsr(3);					//陀螺仪传感器,±2000dps
  21:Module/imu/mpu6050.c ****   MPU_Set_Accel_Fsr(0);					//加速度传感器,±2g
  22:Module/imu/mpu6050.c ****   MPU_Set_Rate(50);						//设置采样率50Hz
  23:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_INT_EN_REG,0X00);	//关闭所有中断
  24:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_USER_CTRL_REG,0X00);	//I2C主模式关闭
  25:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_FIFO_EN_REG,0X00);	//关闭FIFO
  26:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_INTBP_CFG_REG,0X80);	//INT引脚低电平有效
  27:Module/imu/mpu6050.c ****   res=MPU_Read_Byte(MPU_DEVICE_ID_REG);
  28:Module/imu/mpu6050.c **** 	printf("\r\nMPU6050:0x%2x\r\n",res);
  29:Module/imu/mpu6050.c ****   if(res==MPU_ADDR)//器件ID正确
ARM GAS  /tmp/cc4TUbDM.s 			page 2


  30:Module/imu/mpu6050.c ****   {
  31:Module/imu/mpu6050.c ****     MPU_Write_Byte(MPU_PWR_MGMT1_REG,0X01);	//设置CLKSEL,PLL X轴为参考
  32:Module/imu/mpu6050.c ****     MPU_Write_Byte(MPU_PWR_MGMT2_REG,0X00);	//加速度与陀螺仪都工作
  33:Module/imu/mpu6050.c ****     MPU_Set_Rate(50);						//设置采样率为50Hz
  34:Module/imu/mpu6050.c ****   }else 
  35:Module/imu/mpu6050.c **** 		return 1;
  36:Module/imu/mpu6050.c **** 
  37:Module/imu/mpu6050.c ****   
  38:Module/imu/mpu6050.c ****   return 0;
  39:Module/imu/mpu6050.c **** }
  40:Module/imu/mpu6050.c **** //设置MPU6050陀螺仪传感器满量程范围
  41:Module/imu/mpu6050.c **** //fsr:0,±250dps;1,±500dps;2,±1000dps;3,±2000dps
  42:Module/imu/mpu6050.c **** //返回值:0,设置成功
  43:Module/imu/mpu6050.c **** //    其他,设置失败 
  44:Module/imu/mpu6050.c **** uint8_t MPU_Set_Gyro_Fsr(uint8_t fsr)
  45:Module/imu/mpu6050.c **** {
  46:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_GYRO_CFG_REG,fsr<<3);//设置陀螺仪满量程范围  
  47:Module/imu/mpu6050.c **** }
  48:Module/imu/mpu6050.c **** //设置MPU6050加速度传感器满量程范围
  49:Module/imu/mpu6050.c **** //fsr:0,±2g;1,±4g;2,±8g;3,±16g
  50:Module/imu/mpu6050.c **** //返回值:0,设置成功
  51:Module/imu/mpu6050.c **** //    其他,设置失败 
  52:Module/imu/mpu6050.c **** uint8_t MPU_Set_Accel_Fsr(uint8_t fsr)
  53:Module/imu/mpu6050.c **** {
  54:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_ACCEL_CFG_REG,fsr<<3);//设置加速度传感器满量程范围  
  55:Module/imu/mpu6050.c **** }
  56:Module/imu/mpu6050.c **** //设置MPU6050的数字低通滤波器
  57:Module/imu/mpu6050.c **** //lpf:数字低通滤波频率(Hz)
  58:Module/imu/mpu6050.c **** //返回值:0,设置成功
  59:Module/imu/mpu6050.c **** //    其他,设置失败 
  60:Module/imu/mpu6050.c **** uint8_t MPU_Set_LPF(uint16_t lpf)
  61:Module/imu/mpu6050.c **** {
  62:Module/imu/mpu6050.c **** 	uint8_t data=0;
  63:Module/imu/mpu6050.c **** 	if(lpf>=188)data=1;
  64:Module/imu/mpu6050.c **** 	else if(lpf>=98)data=2;
  65:Module/imu/mpu6050.c **** 	else if(lpf>=42)data=3;
  66:Module/imu/mpu6050.c **** 	else if(lpf>=20)data=4;
  67:Module/imu/mpu6050.c **** 	else if(lpf>=10)data=5;
  68:Module/imu/mpu6050.c **** 	else data=6; 
  69:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_CFG_REG,data);//设置数字低通滤波器  
  70:Module/imu/mpu6050.c **** }
  71:Module/imu/mpu6050.c **** //设置MPU6050的采样率(假定Fs=1KHz)
  72:Module/imu/mpu6050.c **** //rate:4~1000(Hz)
  73:Module/imu/mpu6050.c **** //返回值:0,设置成功
  74:Module/imu/mpu6050.c **** //    其他,设置失败 
  75:Module/imu/mpu6050.c **** uint8_t MPU_Set_Rate(uint16_t rate)
  76:Module/imu/mpu6050.c **** {
  77:Module/imu/mpu6050.c **** 	uint8_t data;
  78:Module/imu/mpu6050.c **** 	if(rate>1000)rate=1000;
  79:Module/imu/mpu6050.c **** 	if(rate<4)rate=4;
  80:Module/imu/mpu6050.c **** 	data=1000/rate-1;
  81:Module/imu/mpu6050.c **** 	data=MPU_Write_Byte(MPU_SAMPLE_RATE_REG,data);	//设置数字低通滤波器
  82:Module/imu/mpu6050.c ****  	return MPU_Set_LPF(rate/2);	//自动设置LPF为采样率的一半
  83:Module/imu/mpu6050.c **** }
  84:Module/imu/mpu6050.c ****  
  85:Module/imu/mpu6050.c **** //得到温度值
  86:Module/imu/mpu6050.c **** //返回值:温度值(扩大了100倍)
ARM GAS  /tmp/cc4TUbDM.s 			page 3


  87:Module/imu/mpu6050.c **** float MPU_Get_Temperature(void)
  88:Module/imu/mpu6050.c **** {
  89:Module/imu/mpu6050.c ****   unsigned char  buf[2]; 
  90:Module/imu/mpu6050.c ****   short raw;
  91:Module/imu/mpu6050.c ****   float temp;
  92:Module/imu/mpu6050.c ****   
  93:Module/imu/mpu6050.c ****   MPU_Read_Len(MPU_TEMP_OUTH_REG,2,buf); 
  94:Module/imu/mpu6050.c ****   raw=(buf[0]<<8)| buf[1];  
  95:Module/imu/mpu6050.c ****   temp=(36.53+((double)raw)/340)*100;  
  96:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
  97:Module/imu/mpu6050.c ****   return temp/100.0f;
  98:Module/imu/mpu6050.c **** }
  99:Module/imu/mpu6050.c **** //得到陀螺仪值(原始值)
 100:Module/imu/mpu6050.c **** //gx,gy,gz:陀螺仪x,y,z轴的原始读数(带符号)
 101:Module/imu/mpu6050.c **** //返回值:0,成功
 102:Module/imu/mpu6050.c **** //    其他,错误代码
 103:Module/imu/mpu6050.c **** uint8_t MPU_Get_Gyroscope(short *gx,short *gy,short *gz)
 104:Module/imu/mpu6050.c **** {
 105:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 106:Module/imu/mpu6050.c **** 	res=MPU_Read_Len(MPU_GYRO_XOUTH_REG,6,buf);
 107:Module/imu/mpu6050.c **** 	if(res==0)
 108:Module/imu/mpu6050.c **** 	{
 109:Module/imu/mpu6050.c **** 		*gx=((uint16_t)buf[0]<<8)|buf[1];  
 110:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 111:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 112:Module/imu/mpu6050.c **** 	} 	
 113:Module/imu/mpu6050.c ****     return res;
 114:Module/imu/mpu6050.c **** }
 115:Module/imu/mpu6050.c **** //得到加速度值(原始值)
 116:Module/imu/mpu6050.c **** //gx,gy,gz:陀螺仪x,y,z轴的原始读数(带符号)
 117:Module/imu/mpu6050.c **** //返回值:0,成功
 118:Module/imu/mpu6050.c **** //    其他,错误代码
 119:Module/imu/mpu6050.c **** uint8_t MPU_Get_Accelerometer(short *ax,short *ay,short *az)
 120:Module/imu/mpu6050.c **** {
 121:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 122:Module/imu/mpu6050.c **** 	res=MPU_Read_Len(MPU_ACCEL_XOUTH_REG,6,buf);
 123:Module/imu/mpu6050.c **** 	if(res==0)
 124:Module/imu/mpu6050.c **** 	{
 125:Module/imu/mpu6050.c **** 		*ax=((uint16_t)buf[0]<<8)|buf[1];  
 126:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 127:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 128:Module/imu/mpu6050.c **** 	} 	
 129:Module/imu/mpu6050.c ****     return res;;
 130:Module/imu/mpu6050.c **** }
 131:Module/imu/mpu6050.c ****  
 132:Module/imu/mpu6050.c ****  
 133:Module/imu/mpu6050.c **** //IIC连续写
 134:Module/imu/mpu6050.c **** uint8_t MPU_Write_Len(uint8_t reg,uint8_t len,uint8_t *buf)
 135:Module/imu/mpu6050.c **** {
  30              		.loc 1 135 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 135 1 is_stmt 0 view .LVU1
  35 0000 00B5     		push	{lr}
  36              	.LCFI0:
  37              		.cfi_def_cfa_offset 4
ARM GAS  /tmp/cc4TUbDM.s 			page 4


  38              		.cfi_offset 14, -4
  39 0002 85B0     		sub	sp, sp, #20
  40              	.LCFI1:
  41              		.cfi_def_cfa_offset 24
 136:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
  42              		.loc 1 136 3 is_stmt 1 view .LVU2
 137:Module/imu/mpu6050.c ****   HAL_I2C_Mem_Write(&hi2c1, MPU_WRITE, reg, I2C_MEMADD_SIZE_8BIT, buf, len, 0xfff);
  43              		.loc 1 137 3 view .LVU3
  44 0004 40F6FF73 		movw	r3, #4095
  45 0008 0293     		str	r3, [sp, #8]
  46 000a 0191     		str	r1, [sp, #4]
  47 000c 0092     		str	r2, [sp]
  48 000e 0123     		movs	r3, #1
  49 0010 0246     		mov	r2, r0
  50              	.LVL1:
  51              		.loc 1 137 3 is_stmt 0 view .LVU4
  52 0012 D021     		movs	r1, #208
  53              	.LVL2:
  54              		.loc 1 137 3 view .LVU5
  55 0014 0448     		ldr	r0, .L3
  56              	.LVL3:
  57              		.loc 1 137 3 view .LVU6
  58 0016 FFF7FEFF 		bl	HAL_I2C_Mem_Write
  59              	.LVL4:
 138:Module/imu/mpu6050.c ****   HAL_Delay(100);
  60              		.loc 1 138 3 is_stmt 1 view .LVU7
  61 001a 6420     		movs	r0, #100
  62 001c FFF7FEFF 		bl	HAL_Delay
  63              	.LVL5:
 139:Module/imu/mpu6050.c ****   
 140:Module/imu/mpu6050.c ****   return 0;
  64              		.loc 1 140 3 view .LVU8
 141:Module/imu/mpu6050.c **** }
  65              		.loc 1 141 1 is_stmt 0 view .LVU9
  66 0020 0020     		movs	r0, #0
  67 0022 05B0     		add	sp, sp, #20
  68              	.LCFI2:
  69              		.cfi_def_cfa_offset 4
  70              		@ sp needed
  71 0024 5DF804FB 		ldr	pc, [sp], #4
  72              	.L4:
  73              		.align	2
  74              	.L3:
  75 0028 00000000 		.word	hi2c1
  76              		.cfi_endproc
  77              	.LFE143:
  79              		.section	.text.MPU_Read_Len,"ax",%progbits
  80              		.align	1
  81              		.global	MPU_Read_Len
  82              		.syntax unified
  83              		.thumb
  84              		.thumb_func
  86              	MPU_Read_Len:
  87              	.LVL6:
  88              	.LFB144:
 142:Module/imu/mpu6050.c **** //IIC连续读
 143:Module/imu/mpu6050.c **** //addr:器件地址
ARM GAS  /tmp/cc4TUbDM.s 			page 5


 144:Module/imu/mpu6050.c **** //reg:要读取的寄存器地址
 145:Module/imu/mpu6050.c **** //len:要读取的长度
 146:Module/imu/mpu6050.c **** //buf:读取到的数据存储区
 147:Module/imu/mpu6050.c **** //返回值:0,正常
 148:Module/imu/mpu6050.c **** //    其他,错误代码
 149:Module/imu/mpu6050.c **** uint8_t MPU_Read_Len(uint8_t reg,uint8_t len,uint8_t *buf)
 150:Module/imu/mpu6050.c **** { 
  89              		.loc 1 150 1 is_stmt 1 view -0
  90              		.cfi_startproc
  91              		@ args = 0, pretend = 0, frame = 0
  92              		@ frame_needed = 0, uses_anonymous_args = 0
  93              		.loc 1 150 1 is_stmt 0 view .LVU11
  94 0000 00B5     		push	{lr}
  95              	.LCFI3:
  96              		.cfi_def_cfa_offset 4
  97              		.cfi_offset 14, -4
  98 0002 85B0     		sub	sp, sp, #20
  99              	.LCFI4:
 100              		.cfi_def_cfa_offset 24
 151:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
 101              		.loc 1 151 3 is_stmt 1 view .LVU12
 152:Module/imu/mpu6050.c ****   HAL_I2C_Mem_Read(&hi2c1, MPU_READ, reg, I2C_MEMADD_SIZE_8BIT, buf, len, 0xfff);
 102              		.loc 1 152 3 view .LVU13
 103 0004 40F6FF73 		movw	r3, #4095
 104 0008 0293     		str	r3, [sp, #8]
 105 000a 0191     		str	r1, [sp, #4]
 106 000c 0092     		str	r2, [sp]
 107 000e 0123     		movs	r3, #1
 108 0010 0246     		mov	r2, r0
 109              	.LVL7:
 110              		.loc 1 152 3 is_stmt 0 view .LVU14
 111 0012 D121     		movs	r1, #209
 112              	.LVL8:
 113              		.loc 1 152 3 view .LVU15
 114 0014 0448     		ldr	r0, .L7
 115              	.LVL9:
 116              		.loc 1 152 3 view .LVU16
 117 0016 FFF7FEFF 		bl	HAL_I2C_Mem_Read
 118              	.LVL10:
 153:Module/imu/mpu6050.c ****   HAL_Delay(100);
 119              		.loc 1 153 3 is_stmt 1 view .LVU17
 120 001a 6420     		movs	r0, #100
 121 001c FFF7FEFF 		bl	HAL_Delay
 122              	.LVL11:
 154:Module/imu/mpu6050.c ****   
 155:Module/imu/mpu6050.c ****   return 0;	
 123              		.loc 1 155 3 view .LVU18
 156:Module/imu/mpu6050.c **** }
 124              		.loc 1 156 1 is_stmt 0 view .LVU19
 125 0020 0020     		movs	r0, #0
 126 0022 05B0     		add	sp, sp, #20
 127              	.LCFI5:
 128              		.cfi_def_cfa_offset 4
 129              		@ sp needed
 130 0024 5DF804FB 		ldr	pc, [sp], #4
 131              	.L8:
 132              		.align	2
ARM GAS  /tmp/cc4TUbDM.s 			page 6


 133              	.L7:
 134 0028 00000000 		.word	hi2c1
 135              		.cfi_endproc
 136              	.LFE144:
 138              		.global	__aeabi_i2d
 139              		.global	__aeabi_ddiv
 140              		.global	__aeabi_dadd
 141              		.global	__aeabi_dmul
 142              		.global	__aeabi_d2f
 143              		.section	.text.MPU_Get_Temperature,"ax",%progbits
 144              		.align	1
 145              		.global	MPU_Get_Temperature
 146              		.syntax unified
 147              		.thumb
 148              		.thumb_func
 150              	MPU_Get_Temperature:
 151              	.LFB140:
  88:Module/imu/mpu6050.c ****   unsigned char  buf[2]; 
 152              		.loc 1 88 1 is_stmt 1 view -0
 153              		.cfi_startproc
 154              		@ args = 0, pretend = 0, frame = 8
 155              		@ frame_needed = 0, uses_anonymous_args = 0
 156 0000 00B5     		push	{lr}
 157              	.LCFI6:
 158              		.cfi_def_cfa_offset 4
 159              		.cfi_offset 14, -4
 160 0002 83B0     		sub	sp, sp, #12
 161              	.LCFI7:
 162              		.cfi_def_cfa_offset 16
  89:Module/imu/mpu6050.c ****   short raw;
 163              		.loc 1 89 3 view .LVU21
  90:Module/imu/mpu6050.c ****   float temp;
 164              		.loc 1 90 3 view .LVU22
  91:Module/imu/mpu6050.c ****   
 165              		.loc 1 91 3 view .LVU23
  93:Module/imu/mpu6050.c ****   raw=(buf[0]<<8)| buf[1];  
 166              		.loc 1 93 3 view .LVU24
 167 0004 01AA     		add	r2, sp, #4
 168 0006 0221     		movs	r1, #2
 169 0008 4120     		movs	r0, #65
 170 000a FFF7FEFF 		bl	MPU_Read_Len
 171              	.LVL12:
  94:Module/imu/mpu6050.c ****   temp=(36.53+((double)raw)/340)*100;  
 172              		.loc 1 94 3 view .LVU25
  94:Module/imu/mpu6050.c ****   temp=(36.53+((double)raw)/340)*100;  
 173              		.loc 1 94 11 is_stmt 0 view .LVU26
 174 000e 9DF80430 		ldrb	r3, [sp, #4]	@ zero_extendqisi2
  94:Module/imu/mpu6050.c ****   temp=(36.53+((double)raw)/340)*100;  
 175              		.loc 1 94 18 view .LVU27
 176 0012 1B02     		lsls	r3, r3, #8
 177 0014 1BB2     		sxth	r3, r3
  94:Module/imu/mpu6050.c ****   temp=(36.53+((double)raw)/340)*100;  
 178              		.loc 1 94 23 view .LVU28
 179 0016 9DF80500 		ldrb	r0, [sp, #5]	@ zero_extendqisi2
 180              	.LVL13:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 181              		.loc 1 95 3 is_stmt 1 view .LVU29
ARM GAS  /tmp/cc4TUbDM.s 			page 7


  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 182              		.loc 1 95 16 is_stmt 0 view .LVU30
 183 001a 1843     		orrs	r0, r0, r3
 184              	.LVL14:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 185              		.loc 1 95 16 view .LVU31
 186 001c FFF7FEFF 		bl	__aeabi_i2d
 187              	.LVL15:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 188              		.loc 1 95 28 view .LVU32
 189 0020 0022     		movs	r2, #0
 190 0022 0D4B     		ldr	r3, .L11+8
 191 0024 FFF7FEFF 		bl	__aeabi_ddiv
 192              	.LVL16:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 193              		.loc 1 95 14 view .LVU33
 194 0028 09A3     		adr	r3, .L11
 195 002a D3E90023 		ldrd	r2, [r3]
 196 002e FFF7FEFF 		bl	__aeabi_dadd
 197              	.LVL17:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 198              		.loc 1 95 33 view .LVU34
 199 0032 0022     		movs	r2, #0
 200 0034 094B     		ldr	r3, .L11+12
 201 0036 FFF7FEFF 		bl	__aeabi_dmul
 202              	.LVL18:
  95:Module/imu/mpu6050.c **** //  temp = (long)((35 + (raw / 340)) * 65536L);
 203              		.loc 1 95 7 view .LVU35
 204 003a FFF7FEFF 		bl	__aeabi_d2f
 205              	.LVL19:
 206 003e 00EE100A 		vmov	s0, r0
 207              	.LVL20:
  97:Module/imu/mpu6050.c **** }
 208              		.loc 1 97 3 is_stmt 1 view .LVU36
  98:Module/imu/mpu6050.c **** //得到陀螺仪值(原始值)
 209              		.loc 1 98 1 is_stmt 0 view .LVU37
 210 0042 DFED077A 		vldr.32	s15, .L11+16
 211 0046 80EE270A 		vdiv.f32	s0, s0, s15
 212 004a 03B0     		add	sp, sp, #12
 213              	.LCFI8:
 214              		.cfi_def_cfa_offset 4
 215              		@ sp needed
 216 004c 5DF804FB 		ldr	pc, [sp], #4
 217              	.L12:
 218              		.align	3
 219              	.L11:
 220 0050 A4703D0A 		.word	171798692
 221 0054 D7434240 		.word	1078084567
 222 0058 00407540 		.word	1081425920
 223 005c 00005940 		.word	1079574528
 224 0060 0000C842 		.word	1120403456
 225              		.cfi_endproc
 226              	.LFE140:
 228              		.section	.text.MPU_Get_Gyroscope,"ax",%progbits
 229              		.align	1
 230              		.global	MPU_Get_Gyroscope
 231              		.syntax unified
ARM GAS  /tmp/cc4TUbDM.s 			page 8


 232              		.thumb
 233              		.thumb_func
 235              	MPU_Get_Gyroscope:
 236              	.LVL21:
 237              	.LFB141:
 104:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 238              		.loc 1 104 1 is_stmt 1 view -0
 239              		.cfi_startproc
 240              		@ args = 0, pretend = 0, frame = 8
 241              		@ frame_needed = 0, uses_anonymous_args = 0
 104:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 242              		.loc 1 104 1 is_stmt 0 view .LVU39
 243 0000 70B5     		push	{r4, r5, r6, lr}
 244              	.LCFI9:
 245              		.cfi_def_cfa_offset 16
 246              		.cfi_offset 4, -16
 247              		.cfi_offset 5, -12
 248              		.cfi_offset 6, -8
 249              		.cfi_offset 14, -4
 250 0002 82B0     		sub	sp, sp, #8
 251              	.LCFI10:
 252              		.cfi_def_cfa_offset 24
 253 0004 0646     		mov	r6, r0
 254 0006 0D46     		mov	r5, r1
 255 0008 1446     		mov	r4, r2
 105:Module/imu/mpu6050.c **** 	res=MPU_Read_Len(MPU_GYRO_XOUTH_REG,6,buf);
 256              		.loc 1 105 5 is_stmt 1 view .LVU40
 106:Module/imu/mpu6050.c **** 	if(res==0)
 257              		.loc 1 106 2 view .LVU41
 106:Module/imu/mpu6050.c **** 	if(res==0)
 258              		.loc 1 106 6 is_stmt 0 view .LVU42
 259 000a 6A46     		mov	r2, sp
 260              	.LVL22:
 106:Module/imu/mpu6050.c **** 	if(res==0)
 261              		.loc 1 106 6 view .LVU43
 262 000c 0621     		movs	r1, #6
 263              	.LVL23:
 106:Module/imu/mpu6050.c **** 	if(res==0)
 264              		.loc 1 106 6 view .LVU44
 265 000e 4320     		movs	r0, #67
 266              	.LVL24:
 106:Module/imu/mpu6050.c **** 	if(res==0)
 267              		.loc 1 106 6 view .LVU45
 268 0010 FFF7FEFF 		bl	MPU_Read_Len
 269              	.LVL25:
 107:Module/imu/mpu6050.c **** 	{
 270              		.loc 1 107 2 is_stmt 1 view .LVU46
 107:Module/imu/mpu6050.c **** 	{
 271              		.loc 1 107 4 is_stmt 0 view .LVU47
 272 0014 A0B9     		cbnz	r0, .L14
 109:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 273              		.loc 1 109 3 is_stmt 1 view .LVU48
 109:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 274              		.loc 1 109 21 is_stmt 0 view .LVU49
 275 0016 9DF80020 		ldrb	r2, [sp]	@ zero_extendqisi2
 109:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 276              		.loc 1 109 32 view .LVU50
ARM GAS  /tmp/cc4TUbDM.s 			page 9


 277 001a 9DF80130 		ldrb	r3, [sp, #1]	@ zero_extendqisi2
 109:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 278              		.loc 1 109 28 view .LVU51
 279 001e 43EA0223 		orr	r3, r3, r2, lsl #8
 109:Module/imu/mpu6050.c **** 		*gy=((uint16_t)buf[2]<<8)|buf[3];  
 280              		.loc 1 109 6 view .LVU52
 281 0022 3380     		strh	r3, [r6]	@ movhi
 110:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 282              		.loc 1 110 3 is_stmt 1 view .LVU53
 110:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 283              		.loc 1 110 21 is_stmt 0 view .LVU54
 284 0024 9DF80220 		ldrb	r2, [sp, #2]	@ zero_extendqisi2
 110:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 285              		.loc 1 110 32 view .LVU55
 286 0028 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 110:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 287              		.loc 1 110 28 view .LVU56
 288 002c 43EA0223 		orr	r3, r3, r2, lsl #8
 110:Module/imu/mpu6050.c **** 		*gz=((uint16_t)buf[4]<<8)|buf[5];
 289              		.loc 1 110 6 view .LVU57
 290 0030 2B80     		strh	r3, [r5]	@ movhi
 111:Module/imu/mpu6050.c **** 	} 	
 291              		.loc 1 111 3 is_stmt 1 view .LVU58
 111:Module/imu/mpu6050.c **** 	} 	
 292              		.loc 1 111 21 is_stmt 0 view .LVU59
 293 0032 9DF80420 		ldrb	r2, [sp, #4]	@ zero_extendqisi2
 111:Module/imu/mpu6050.c **** 	} 	
 294              		.loc 1 111 32 view .LVU60
 295 0036 9DF80530 		ldrb	r3, [sp, #5]	@ zero_extendqisi2
 111:Module/imu/mpu6050.c **** 	} 	
 296              		.loc 1 111 28 view .LVU61
 297 003a 43EA0223 		orr	r3, r3, r2, lsl #8
 111:Module/imu/mpu6050.c **** 	} 	
 298              		.loc 1 111 6 view .LVU62
 299 003e 2380     		strh	r3, [r4]	@ movhi
 300              	.L14:
 113:Module/imu/mpu6050.c **** }
 301              		.loc 1 113 5 is_stmt 1 view .LVU63
 114:Module/imu/mpu6050.c **** //得到加速度值(原始值)
 302              		.loc 1 114 1 is_stmt 0 view .LVU64
 303 0040 02B0     		add	sp, sp, #8
 304              	.LCFI11:
 305              		.cfi_def_cfa_offset 16
 306              		@ sp needed
 307 0042 70BD     		pop	{r4, r5, r6, pc}
 114:Module/imu/mpu6050.c **** //得到加速度值(原始值)
 308              		.loc 1 114 1 view .LVU65
 309              		.cfi_endproc
 310              	.LFE141:
 312              		.section	.text.MPU_Get_Accelerometer,"ax",%progbits
 313              		.align	1
 314              		.global	MPU_Get_Accelerometer
 315              		.syntax unified
 316              		.thumb
 317              		.thumb_func
 319              	MPU_Get_Accelerometer:
 320              	.LVL26:
ARM GAS  /tmp/cc4TUbDM.s 			page 10


 321              	.LFB142:
 120:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 322              		.loc 1 120 1 is_stmt 1 view -0
 323              		.cfi_startproc
 324              		@ args = 0, pretend = 0, frame = 8
 325              		@ frame_needed = 0, uses_anonymous_args = 0
 120:Module/imu/mpu6050.c ****     uint8_t buf[6],res;  
 326              		.loc 1 120 1 is_stmt 0 view .LVU67
 327 0000 70B5     		push	{r4, r5, r6, lr}
 328              	.LCFI12:
 329              		.cfi_def_cfa_offset 16
 330              		.cfi_offset 4, -16
 331              		.cfi_offset 5, -12
 332              		.cfi_offset 6, -8
 333              		.cfi_offset 14, -4
 334 0002 82B0     		sub	sp, sp, #8
 335              	.LCFI13:
 336              		.cfi_def_cfa_offset 24
 337 0004 0646     		mov	r6, r0
 338 0006 0D46     		mov	r5, r1
 339 0008 1446     		mov	r4, r2
 121:Module/imu/mpu6050.c **** 	res=MPU_Read_Len(MPU_ACCEL_XOUTH_REG,6,buf);
 340              		.loc 1 121 5 is_stmt 1 view .LVU68
 122:Module/imu/mpu6050.c **** 	if(res==0)
 341              		.loc 1 122 2 view .LVU69
 122:Module/imu/mpu6050.c **** 	if(res==0)
 342              		.loc 1 122 6 is_stmt 0 view .LVU70
 343 000a 6A46     		mov	r2, sp
 344              	.LVL27:
 122:Module/imu/mpu6050.c **** 	if(res==0)
 345              		.loc 1 122 6 view .LVU71
 346 000c 0621     		movs	r1, #6
 347              	.LVL28:
 122:Module/imu/mpu6050.c **** 	if(res==0)
 348              		.loc 1 122 6 view .LVU72
 349 000e 3B20     		movs	r0, #59
 350              	.LVL29:
 122:Module/imu/mpu6050.c **** 	if(res==0)
 351              		.loc 1 122 6 view .LVU73
 352 0010 FFF7FEFF 		bl	MPU_Read_Len
 353              	.LVL30:
 123:Module/imu/mpu6050.c **** 	{
 354              		.loc 1 123 2 is_stmt 1 view .LVU74
 123:Module/imu/mpu6050.c **** 	{
 355              		.loc 1 123 4 is_stmt 0 view .LVU75
 356 0014 A0B9     		cbnz	r0, .L17
 125:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 357              		.loc 1 125 3 is_stmt 1 view .LVU76
 125:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 358              		.loc 1 125 21 is_stmt 0 view .LVU77
 359 0016 9DF80020 		ldrb	r2, [sp]	@ zero_extendqisi2
 125:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 360              		.loc 1 125 32 view .LVU78
 361 001a 9DF80130 		ldrb	r3, [sp, #1]	@ zero_extendqisi2
 125:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 362              		.loc 1 125 28 view .LVU79
 363 001e 43EA0223 		orr	r3, r3, r2, lsl #8
ARM GAS  /tmp/cc4TUbDM.s 			page 11


 125:Module/imu/mpu6050.c **** 		*ay=((uint16_t)buf[2]<<8)|buf[3];  
 364              		.loc 1 125 6 view .LVU80
 365 0022 3380     		strh	r3, [r6]	@ movhi
 126:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 366              		.loc 1 126 3 is_stmt 1 view .LVU81
 126:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 367              		.loc 1 126 21 is_stmt 0 view .LVU82
 368 0024 9DF80220 		ldrb	r2, [sp, #2]	@ zero_extendqisi2
 126:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 369              		.loc 1 126 32 view .LVU83
 370 0028 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 126:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 371              		.loc 1 126 28 view .LVU84
 372 002c 43EA0223 		orr	r3, r3, r2, lsl #8
 126:Module/imu/mpu6050.c **** 		*az=((uint16_t)buf[4]<<8)|buf[5];
 373              		.loc 1 126 6 view .LVU85
 374 0030 2B80     		strh	r3, [r5]	@ movhi
 127:Module/imu/mpu6050.c **** 	} 	
 375              		.loc 1 127 3 is_stmt 1 view .LVU86
 127:Module/imu/mpu6050.c **** 	} 	
 376              		.loc 1 127 21 is_stmt 0 view .LVU87
 377 0032 9DF80420 		ldrb	r2, [sp, #4]	@ zero_extendqisi2
 127:Module/imu/mpu6050.c **** 	} 	
 378              		.loc 1 127 32 view .LVU88
 379 0036 9DF80530 		ldrb	r3, [sp, #5]	@ zero_extendqisi2
 127:Module/imu/mpu6050.c **** 	} 	
 380              		.loc 1 127 28 view .LVU89
 381 003a 43EA0223 		orr	r3, r3, r2, lsl #8
 127:Module/imu/mpu6050.c **** 	} 	
 382              		.loc 1 127 6 view .LVU90
 383 003e 2380     		strh	r3, [r4]	@ movhi
 384              	.L17:
 129:Module/imu/mpu6050.c **** }
 385              		.loc 1 129 5 is_stmt 1 view .LVU91
 129:Module/imu/mpu6050.c **** }
 386              		.loc 1 129 16 discriminator 1 view .LVU92
 130:Module/imu/mpu6050.c ****  
 387              		.loc 1 130 1 is_stmt 0 view .LVU93
 388 0040 02B0     		add	sp, sp, #8
 389              	.LCFI14:
 390              		.cfi_def_cfa_offset 16
 391              		@ sp needed
 392 0042 70BD     		pop	{r4, r5, r6, pc}
 130:Module/imu/mpu6050.c ****  
 393              		.loc 1 130 1 view .LVU94
 394              		.cfi_endproc
 395              	.LFE142:
 397              		.section	.text.MPU_Write_Byte,"ax",%progbits
 398              		.align	1
 399              		.global	MPU_Write_Byte
 400              		.syntax unified
 401              		.thumb
 402              		.thumb_func
 404              	MPU_Write_Byte:
 405              	.LVL31:
 406              	.LFB145:
 157:Module/imu/mpu6050.c **** //IIC写一个字节 
ARM GAS  /tmp/cc4TUbDM.s 			page 12


 158:Module/imu/mpu6050.c **** //reg:寄存器地址
 159:Module/imu/mpu6050.c **** //data:数据
 160:Module/imu/mpu6050.c **** //返回值:0,正常
 161:Module/imu/mpu6050.c **** //    其他,错误代码
 162:Module/imu/mpu6050.c **** uint8_t MPU_Write_Byte(uint8_t reg,uint8_t data) 				 
 163:Module/imu/mpu6050.c **** { 
 407              		.loc 1 163 1 is_stmt 1 view -0
 408              		.cfi_startproc
 409              		@ args = 0, pretend = 0, frame = 8
 410              		@ frame_needed = 0, uses_anonymous_args = 0
 411              		.loc 1 163 1 is_stmt 0 view .LVU96
 412 0000 10B5     		push	{r4, lr}
 413              	.LCFI15:
 414              		.cfi_def_cfa_offset 8
 415              		.cfi_offset 4, -8
 416              		.cfi_offset 14, -4
 417 0002 86B0     		sub	sp, sp, #24
 418              	.LCFI16:
 419              		.cfi_def_cfa_offset 32
 420 0004 0246     		mov	r2, r0
 164:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
 421              		.loc 1 164 3 is_stmt 1 view .LVU97
 165:Module/imu/mpu6050.c ****   unsigned char W_Data=0;
 422              		.loc 1 165 3 view .LVU98
 423              		.loc 1 165 17 is_stmt 0 view .LVU99
 424 0006 0024     		movs	r4, #0
 425 0008 8DF81740 		strb	r4, [sp, #23]
 166:Module/imu/mpu6050.c ****  
 167:Module/imu/mpu6050.c ****   W_Data = data;
 426              		.loc 1 167 3 is_stmt 1 view .LVU100
 427              		.loc 1 167 10 is_stmt 0 view .LVU101
 428 000c 8DF81710 		strb	r1, [sp, #23]
 168:Module/imu/mpu6050.c ****   HAL_I2C_Mem_Write(&hi2c1, MPU_WRITE, reg, I2C_MEMADD_SIZE_8BIT, &W_Data, 1, 0xfff);
 429              		.loc 1 168 3 is_stmt 1 view .LVU102
 430 0010 40F6FF73 		movw	r3, #4095
 431 0014 0293     		str	r3, [sp, #8]
 432 0016 0123     		movs	r3, #1
 433 0018 0193     		str	r3, [sp, #4]
 434 001a 0DF11701 		add	r1, sp, #23
 435              	.LVL32:
 436              		.loc 1 168 3 is_stmt 0 view .LVU103
 437 001e 0091     		str	r1, [sp]
 438 0020 D021     		movs	r1, #208
 439              	.LVL33:
 440              		.loc 1 168 3 view .LVU104
 441 0022 0448     		ldr	r0, .L21
 442              	.LVL34:
 443              		.loc 1 168 3 view .LVU105
 444 0024 FFF7FEFF 		bl	HAL_I2C_Mem_Write
 445              	.LVL35:
 169:Module/imu/mpu6050.c ****   HAL_Delay(100);
 446              		.loc 1 169 3 is_stmt 1 view .LVU106
 447 0028 6420     		movs	r0, #100
 448 002a FFF7FEFF 		bl	HAL_Delay
 449              	.LVL36:
 170:Module/imu/mpu6050.c ****   
 171:Module/imu/mpu6050.c ****   return 0;
ARM GAS  /tmp/cc4TUbDM.s 			page 13


 450              		.loc 1 171 3 view .LVU107
 172:Module/imu/mpu6050.c **** }
 451              		.loc 1 172 1 is_stmt 0 view .LVU108
 452 002e 2046     		mov	r0, r4
 453 0030 06B0     		add	sp, sp, #24
 454              	.LCFI17:
 455              		.cfi_def_cfa_offset 8
 456              		@ sp needed
 457 0032 10BD     		pop	{r4, pc}
 458              	.L22:
 459              		.align	2
 460              	.L21:
 461 0034 00000000 		.word	hi2c1
 462              		.cfi_endproc
 463              	.LFE145:
 465              		.section	.text.MPU_Set_Gyro_Fsr,"ax",%progbits
 466              		.align	1
 467              		.global	MPU_Set_Gyro_Fsr
 468              		.syntax unified
 469              		.thumb
 470              		.thumb_func
 472              	MPU_Set_Gyro_Fsr:
 473              	.LVL37:
 474              	.LFB136:
  45:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_GYRO_CFG_REG,fsr<<3);//设置陀螺仪满量程范围  
 475              		.loc 1 45 1 is_stmt 1 view -0
 476              		.cfi_startproc
 477              		@ args = 0, pretend = 0, frame = 0
 478              		@ frame_needed = 0, uses_anonymous_args = 0
  45:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_GYRO_CFG_REG,fsr<<3);//设置陀螺仪满量程范围  
 479              		.loc 1 45 1 is_stmt 0 view .LVU110
 480 0000 08B5     		push	{r3, lr}
 481              	.LCFI18:
 482              		.cfi_def_cfa_offset 8
 483              		.cfi_offset 3, -8
 484              		.cfi_offset 14, -4
  46:Module/imu/mpu6050.c **** }
 485              		.loc 1 46 2 is_stmt 1 view .LVU111
  46:Module/imu/mpu6050.c **** }
 486              		.loc 1 46 9 is_stmt 0 view .LVU112
 487 0002 C100     		lsls	r1, r0, #3
 488 0004 01F0F801 		and	r1, r1, #248
 489 0008 1B20     		movs	r0, #27
 490              	.LVL38:
  46:Module/imu/mpu6050.c **** }
 491              		.loc 1 46 9 view .LVU113
 492 000a FFF7FEFF 		bl	MPU_Write_Byte
 493              	.LVL39:
  47:Module/imu/mpu6050.c **** //设置MPU6050加速度传感器满量程范围
 494              		.loc 1 47 1 view .LVU114
 495 000e 08BD     		pop	{r3, pc}
 496              		.cfi_endproc
 497              	.LFE136:
 499              		.section	.text.MPU_Set_Accel_Fsr,"ax",%progbits
 500              		.align	1
 501              		.global	MPU_Set_Accel_Fsr
 502              		.syntax unified
ARM GAS  /tmp/cc4TUbDM.s 			page 14


 503              		.thumb
 504              		.thumb_func
 506              	MPU_Set_Accel_Fsr:
 507              	.LVL40:
 508              	.LFB137:
  53:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_ACCEL_CFG_REG,fsr<<3);//设置加速度传感器满量程范围  
 509              		.loc 1 53 1 is_stmt 1 view -0
 510              		.cfi_startproc
 511              		@ args = 0, pretend = 0, frame = 0
 512              		@ frame_needed = 0, uses_anonymous_args = 0
  53:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_ACCEL_CFG_REG,fsr<<3);//设置加速度传感器满量程范围  
 513              		.loc 1 53 1 is_stmt 0 view .LVU116
 514 0000 08B5     		push	{r3, lr}
 515              	.LCFI19:
 516              		.cfi_def_cfa_offset 8
 517              		.cfi_offset 3, -8
 518              		.cfi_offset 14, -4
  54:Module/imu/mpu6050.c **** }
 519              		.loc 1 54 2 is_stmt 1 view .LVU117
  54:Module/imu/mpu6050.c **** }
 520              		.loc 1 54 9 is_stmt 0 view .LVU118
 521 0002 C100     		lsls	r1, r0, #3
 522 0004 01F0F801 		and	r1, r1, #248
 523 0008 1C20     		movs	r0, #28
 524              	.LVL41:
  54:Module/imu/mpu6050.c **** }
 525              		.loc 1 54 9 view .LVU119
 526 000a FFF7FEFF 		bl	MPU_Write_Byte
 527              	.LVL42:
  55:Module/imu/mpu6050.c **** //设置MPU6050的数字低通滤波器
 528              		.loc 1 55 1 view .LVU120
 529 000e 08BD     		pop	{r3, pc}
 530              		.cfi_endproc
 531              	.LFE137:
 533              		.section	.text.MPU_Set_LPF,"ax",%progbits
 534              		.align	1
 535              		.global	MPU_Set_LPF
 536              		.syntax unified
 537              		.thumb
 538              		.thumb_func
 540              	MPU_Set_LPF:
 541              	.LVL43:
 542              	.LFB138:
  61:Module/imu/mpu6050.c **** 	uint8_t data=0;
 543              		.loc 1 61 1 is_stmt 1 view -0
 544              		.cfi_startproc
 545              		@ args = 0, pretend = 0, frame = 0
 546              		@ frame_needed = 0, uses_anonymous_args = 0
  61:Module/imu/mpu6050.c **** 	uint8_t data=0;
 547              		.loc 1 61 1 is_stmt 0 view .LVU122
 548 0000 08B5     		push	{r3, lr}
 549              	.LCFI20:
 550              		.cfi_def_cfa_offset 8
 551              		.cfi_offset 3, -8
 552              		.cfi_offset 14, -4
  62:Module/imu/mpu6050.c **** 	if(lpf>=188)data=1;
 553              		.loc 1 62 2 is_stmt 1 view .LVU123
ARM GAS  /tmp/cc4TUbDM.s 			page 15


 554              	.LVL44:
  63:Module/imu/mpu6050.c **** 	else if(lpf>=98)data=2;
 555              		.loc 1 63 2 view .LVU124
  63:Module/imu/mpu6050.c **** 	else if(lpf>=98)data=2;
 556              		.loc 1 63 4 is_stmt 0 view .LVU125
 557 0002 BB28     		cmp	r0, #187
 558 0004 09D8     		bhi	.L29
  64:Module/imu/mpu6050.c **** 	else if(lpf>=42)data=3;
 559              		.loc 1 64 7 is_stmt 1 view .LVU126
  64:Module/imu/mpu6050.c **** 	else if(lpf>=42)data=3;
 560              		.loc 1 64 9 is_stmt 0 view .LVU127
 561 0006 6128     		cmp	r0, #97
 562 0008 0CD8     		bhi	.L30
  65:Module/imu/mpu6050.c **** 	else if(lpf>=20)data=4;
 563              		.loc 1 65 7 is_stmt 1 view .LVU128
  65:Module/imu/mpu6050.c **** 	else if(lpf>=20)data=4;
 564              		.loc 1 65 9 is_stmt 0 view .LVU129
 565 000a 2928     		cmp	r0, #41
 566 000c 0CD8     		bhi	.L31
  66:Module/imu/mpu6050.c **** 	else if(lpf>=10)data=5;
 567              		.loc 1 66 7 is_stmt 1 view .LVU130
  66:Module/imu/mpu6050.c **** 	else if(lpf>=10)data=5;
 568              		.loc 1 66 9 is_stmt 0 view .LVU131
 569 000e 1328     		cmp	r0, #19
 570 0010 0CD8     		bhi	.L32
  67:Module/imu/mpu6050.c **** 	else data=6; 
 571              		.loc 1 67 7 is_stmt 1 view .LVU132
  67:Module/imu/mpu6050.c **** 	else data=6; 
 572              		.loc 1 67 9 is_stmt 0 view .LVU133
 573 0012 0928     		cmp	r0, #9
 574 0014 0CD9     		bls	.L33
  67:Module/imu/mpu6050.c **** 	else data=6; 
 575              		.loc 1 67 22 discriminator 1 view .LVU134
 576 0016 0521     		movs	r1, #5
 577 0018 00E0     		b	.L28
 578              	.L29:
  63:Module/imu/mpu6050.c **** 	else if(lpf>=98)data=2;
 579              		.loc 1 63 18 discriminator 1 view .LVU135
 580 001a 0121     		movs	r1, #1
 581              	.L28:
 582              	.LVL45:
  69:Module/imu/mpu6050.c **** }
 583              		.loc 1 69 2 is_stmt 1 view .LVU136
  69:Module/imu/mpu6050.c **** }
 584              		.loc 1 69 9 is_stmt 0 view .LVU137
 585 001c 1A20     		movs	r0, #26
 586              	.LVL46:
  69:Module/imu/mpu6050.c **** }
 587              		.loc 1 69 9 view .LVU138
 588 001e FFF7FEFF 		bl	MPU_Write_Byte
 589              	.LVL47:
  70:Module/imu/mpu6050.c **** //设置MPU6050的采样率(假定Fs=1KHz)
 590              		.loc 1 70 1 view .LVU139
 591 0022 08BD     		pop	{r3, pc}
 592              	.LVL48:
 593              	.L30:
  64:Module/imu/mpu6050.c **** 	else if(lpf>=42)data=3;
ARM GAS  /tmp/cc4TUbDM.s 			page 16


 594              		.loc 1 64 22 discriminator 1 view .LVU140
 595 0024 0221     		movs	r1, #2
 596 0026 F9E7     		b	.L28
 597              	.L31:
  65:Module/imu/mpu6050.c **** 	else if(lpf>=20)data=4;
 598              		.loc 1 65 22 discriminator 1 view .LVU141
 599 0028 0321     		movs	r1, #3
 600 002a F7E7     		b	.L28
 601              	.L32:
  66:Module/imu/mpu6050.c **** 	else if(lpf>=10)data=5;
 602              		.loc 1 66 22 discriminator 1 view .LVU142
 603 002c 0421     		movs	r1, #4
 604 002e F5E7     		b	.L28
 605              	.L33:
  68:Module/imu/mpu6050.c **** 	return MPU_Write_Byte(MPU_CFG_REG,data);//设置数字低通滤波器  
 606              		.loc 1 68 11 view .LVU143
 607 0030 0621     		movs	r1, #6
 608 0032 F3E7     		b	.L28
 609              		.cfi_endproc
 610              	.LFE138:
 612              		.section	.text.MPU_Set_Rate,"ax",%progbits
 613              		.align	1
 614              		.global	MPU_Set_Rate
 615              		.syntax unified
 616              		.thumb
 617              		.thumb_func
 619              	MPU_Set_Rate:
 620              	.LVL49:
 621              	.LFB139:
  76:Module/imu/mpu6050.c **** 	uint8_t data;
 622              		.loc 1 76 1 is_stmt 1 view -0
 623              		.cfi_startproc
 624              		@ args = 0, pretend = 0, frame = 0
 625              		@ frame_needed = 0, uses_anonymous_args = 0
  76:Module/imu/mpu6050.c **** 	uint8_t data;
 626              		.loc 1 76 1 is_stmt 0 view .LVU145
 627 0000 10B5     		push	{r4, lr}
 628              	.LCFI21:
 629              		.cfi_def_cfa_offset 8
 630              		.cfi_offset 4, -8
 631              		.cfi_offset 14, -4
  77:Module/imu/mpu6050.c **** 	if(rate>1000)rate=1000;
 632              		.loc 1 77 2 is_stmt 1 view .LVU146
  78:Module/imu/mpu6050.c **** 	if(rate<4)rate=4;
 633              		.loc 1 78 2 view .LVU147
  78:Module/imu/mpu6050.c **** 	if(rate<4)rate=4;
 634              		.loc 1 78 4 is_stmt 0 view .LVU148
 635 0002 B0F57A7F 		cmp	r0, #1000
 636 0006 04D8     		bhi	.L37
 637 0008 0446     		mov	r4, r0
  79:Module/imu/mpu6050.c **** 	data=1000/rate-1;
 638              		.loc 1 79 2 is_stmt 1 view .LVU149
  79:Module/imu/mpu6050.c **** 	data=1000/rate-1;
 639              		.loc 1 79 4 is_stmt 0 view .LVU150
 640 000a 0328     		cmp	r0, #3
 641 000c 03D8     		bhi	.L36
  79:Module/imu/mpu6050.c **** 	data=1000/rate-1;
ARM GAS  /tmp/cc4TUbDM.s 			page 17


 642              		.loc 1 79 16 discriminator 1 view .LVU151
 643 000e 0424     		movs	r4, #4
 644 0010 01E0     		b	.L36
 645              	.L37:
  78:Module/imu/mpu6050.c **** 	if(rate<4)rate=4;
 646              		.loc 1 78 19 discriminator 1 view .LVU152
 647 0012 4FF47A74 		mov	r4, #1000
 648              	.L36:
 649              	.LVL50:
  80:Module/imu/mpu6050.c **** 	data=MPU_Write_Byte(MPU_SAMPLE_RATE_REG,data);	//设置数字低通滤波器
 650              		.loc 1 80 2 is_stmt 1 view .LVU153
  80:Module/imu/mpu6050.c **** 	data=MPU_Write_Byte(MPU_SAMPLE_RATE_REG,data);	//设置数字低通滤波器
 651              		.loc 1 80 11 is_stmt 0 view .LVU154
 652 0016 4FF47A71 		mov	r1, #1000
 653 001a 91FBF4F1 		sdiv	r1, r1, r4
  80:Module/imu/mpu6050.c **** 	data=MPU_Write_Byte(MPU_SAMPLE_RATE_REG,data);	//设置数字低通滤波器
 654              		.loc 1 80 16 view .LVU155
 655 001e C9B2     		uxtb	r1, r1
  80:Module/imu/mpu6050.c **** 	data=MPU_Write_Byte(MPU_SAMPLE_RATE_REG,data);	//设置数字低通滤波器
 656              		.loc 1 80 6 view .LVU156
 657 0020 0139     		subs	r1, r1, #1
 658              	.LVL51:
  81:Module/imu/mpu6050.c ****  	return MPU_Set_LPF(rate/2);	//自动设置LPF为采样率的一半
 659              		.loc 1 81 2 is_stmt 1 view .LVU157
  81:Module/imu/mpu6050.c ****  	return MPU_Set_LPF(rate/2);	//自动设置LPF为采样率的一半
 660              		.loc 1 81 7 is_stmt 0 view .LVU158
 661 0022 C9B2     		uxtb	r1, r1
  81:Module/imu/mpu6050.c ****  	return MPU_Set_LPF(rate/2);	//自动设置LPF为采样率的一半
 662              		.loc 1 81 7 view .LVU159
 663 0024 1920     		movs	r0, #25
 664 0026 FFF7FEFF 		bl	MPU_Write_Byte
 665              	.LVL52:
  82:Module/imu/mpu6050.c **** }
 666              		.loc 1 82 3 is_stmt 1 view .LVU160
  82:Module/imu/mpu6050.c **** }
 667              		.loc 1 82 10 is_stmt 0 view .LVU161
 668 002a 6008     		lsrs	r0, r4, #1
 669 002c FFF7FEFF 		bl	MPU_Set_LPF
 670              	.LVL53:
  83:Module/imu/mpu6050.c ****  
 671              		.loc 1 83 1 view .LVU162
 672 0030 10BD     		pop	{r4, pc}
  83:Module/imu/mpu6050.c ****  
 673              		.loc 1 83 1 view .LVU163
 674              		.cfi_endproc
 675              	.LFE139:
 677              		.section	.text.MPU_Read_Byte,"ax",%progbits
 678              		.align	1
 679              		.global	MPU_Read_Byte
 680              		.syntax unified
 681              		.thumb
 682              		.thumb_func
 684              	MPU_Read_Byte:
 685              	.LVL54:
 686              	.LFB146:
 173:Module/imu/mpu6050.c **** //IIC读一个字节 
 174:Module/imu/mpu6050.c **** //reg:寄存器地址 
ARM GAS  /tmp/cc4TUbDM.s 			page 18


 175:Module/imu/mpu6050.c **** //返回值:读到的数据
 176:Module/imu/mpu6050.c **** uint8_t MPU_Read_Byte(uint8_t reg)
 177:Module/imu/mpu6050.c **** {
 687              		.loc 1 177 1 is_stmt 1 view -0
 688              		.cfi_startproc
 689              		@ args = 0, pretend = 0, frame = 8
 690              		@ frame_needed = 0, uses_anonymous_args = 0
 691              		.loc 1 177 1 is_stmt 0 view .LVU165
 692 0000 00B5     		push	{lr}
 693              	.LCFI22:
 694              		.cfi_def_cfa_offset 4
 695              		.cfi_offset 14, -4
 696 0002 87B0     		sub	sp, sp, #28
 697              	.LCFI23:
 698              		.cfi_def_cfa_offset 32
 699 0004 0246     		mov	r2, r0
 178:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
 700              		.loc 1 178 3 is_stmt 1 view .LVU166
 179:Module/imu/mpu6050.c ****   unsigned char R_Data=0;
 701              		.loc 1 179 3 view .LVU167
 702              		.loc 1 179 17 is_stmt 0 view .LVU168
 703 0006 0023     		movs	r3, #0
 704 0008 8DF81730 		strb	r3, [sp, #23]
 180:Module/imu/mpu6050.c ****   
 181:Module/imu/mpu6050.c ****   HAL_I2C_Mem_Read(&hi2c1, MPU_READ, reg, I2C_MEMADD_SIZE_8BIT, &R_Data, 1, 0xfff);
 705              		.loc 1 181 3 is_stmt 1 view .LVU169
 706 000c 40F6FF73 		movw	r3, #4095
 707 0010 0293     		str	r3, [sp, #8]
 708 0012 0123     		movs	r3, #1
 709 0014 0193     		str	r3, [sp, #4]
 710 0016 0DF11701 		add	r1, sp, #23
 711 001a 0091     		str	r1, [sp]
 712 001c D121     		movs	r1, #209
 713 001e 0548     		ldr	r0, .L42
 714              	.LVL55:
 715              		.loc 1 181 3 is_stmt 0 view .LVU170
 716 0020 FFF7FEFF 		bl	HAL_I2C_Mem_Read
 717              	.LVL56:
 182:Module/imu/mpu6050.c ****   HAL_Delay(100);
 718              		.loc 1 182 3 is_stmt 1 view .LVU171
 719 0024 6420     		movs	r0, #100
 720 0026 FFF7FEFF 		bl	HAL_Delay
 721              	.LVL57:
 183:Module/imu/mpu6050.c ****   
 184:Module/imu/mpu6050.c ****   return R_Data;		
 722              		.loc 1 184 3 view .LVU172
 185:Module/imu/mpu6050.c **** }
 723              		.loc 1 185 1 is_stmt 0 view .LVU173
 724 002a 9DF81700 		ldrb	r0, [sp, #23]	@ zero_extendqisi2
 725 002e 07B0     		add	sp, sp, #28
 726              	.LCFI24:
 727              		.cfi_def_cfa_offset 4
 728              		@ sp needed
 729 0030 5DF804FB 		ldr	pc, [sp], #4
 730              	.L43:
 731              		.align	2
 732              	.L42:
ARM GAS  /tmp/cc4TUbDM.s 			page 19


 733 0034 00000000 		.word	hi2c1
 734              		.cfi_endproc
 735              	.LFE146:
 737              		.section	.rodata.MPU_Init.str1.4,"aMS",%progbits,1
 738              		.align	2
 739              	.LC0:
 740 0000 0D0A4D50 		.ascii	"\015\012MPU6050:0x%2x\015\012\000"
 740      55363035 
 740      303A3078 
 740      2532780D 
 740      0A00
 741              		.section	.text.MPU_Init,"ax",%progbits
 742              		.align	1
 743              		.global	MPU_Init
 744              		.syntax unified
 745              		.thumb
 746              		.thumb_func
 748              	MPU_Init:
 749              	.LFB135:
  14:Module/imu/mpu6050.c ****   uint8_t res;
 750              		.loc 1 14 1 is_stmt 1 view -0
 751              		.cfi_startproc
 752              		@ args = 0, pretend = 0, frame = 0
 753              		@ frame_needed = 0, uses_anonymous_args = 0
 754 0000 10B5     		push	{r4, lr}
 755              	.LCFI25:
 756              		.cfi_def_cfa_offset 8
 757              		.cfi_offset 4, -8
 758              		.cfi_offset 14, -4
  15:Module/imu/mpu6050.c ****   extern I2C_HandleTypeDef hi2c1;
 759              		.loc 1 15 3 view .LVU175
  16:Module/imu/mpu6050.c ****   HAL_I2C_Init(&hi2c1);
 760              		.loc 1 16 3 view .LVU176
  17:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_PWR_MGMT1_REG,0X80);	//复位MPU6050
 761              		.loc 1 17 3 view .LVU177
 762 0002 1E48     		ldr	r0, .L49
 763 0004 FFF7FEFF 		bl	HAL_I2C_Init
 764              	.LVL58:
  18:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_PWR_MGMT1_REG,0X00);	//唤醒MPU6050 
 765              		.loc 1 18 3 view .LVU178
 766 0008 8021     		movs	r1, #128
 767 000a 6B20     		movs	r0, #107
 768 000c FFF7FEFF 		bl	MPU_Write_Byte
 769              	.LVL59:
  19:Module/imu/mpu6050.c ****   MPU_Set_Gyro_Fsr(3);					//陀螺仪传感器,±2000dps
 770              		.loc 1 19 3 view .LVU179
 771 0010 0021     		movs	r1, #0
 772 0012 6B20     		movs	r0, #107
 773 0014 FFF7FEFF 		bl	MPU_Write_Byte
 774              	.LVL60:
  20:Module/imu/mpu6050.c ****   MPU_Set_Accel_Fsr(0);					//加速度传感器,±2g
 775              		.loc 1 20 3 view .LVU180
 776 0018 0320     		movs	r0, #3
 777 001a FFF7FEFF 		bl	MPU_Set_Gyro_Fsr
 778              	.LVL61:
  21:Module/imu/mpu6050.c ****   MPU_Set_Rate(50);						//设置采样率50Hz
 779              		.loc 1 21 3 view .LVU181
ARM GAS  /tmp/cc4TUbDM.s 			page 20


 780 001e 0020     		movs	r0, #0
 781 0020 FFF7FEFF 		bl	MPU_Set_Accel_Fsr
 782              	.LVL62:
  22:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_INT_EN_REG,0X00);	//关闭所有中断
 783              		.loc 1 22 3 view .LVU182
 784 0024 3220     		movs	r0, #50
 785 0026 FFF7FEFF 		bl	MPU_Set_Rate
 786              	.LVL63:
  23:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_USER_CTRL_REG,0X00);	//I2C主模式关闭
 787              		.loc 1 23 3 view .LVU183
 788 002a 0021     		movs	r1, #0
 789 002c 3820     		movs	r0, #56
 790 002e FFF7FEFF 		bl	MPU_Write_Byte
 791              	.LVL64:
  24:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_FIFO_EN_REG,0X00);	//关闭FIFO
 792              		.loc 1 24 3 view .LVU184
 793 0032 0021     		movs	r1, #0
 794 0034 6A20     		movs	r0, #106
 795 0036 FFF7FEFF 		bl	MPU_Write_Byte
 796              	.LVL65:
  25:Module/imu/mpu6050.c ****   MPU_Write_Byte(MPU_INTBP_CFG_REG,0X80);	//INT引脚低电平有效
 797              		.loc 1 25 3 view .LVU185
 798 003a 0021     		movs	r1, #0
 799 003c 2320     		movs	r0, #35
 800 003e FFF7FEFF 		bl	MPU_Write_Byte
 801              	.LVL66:
  26:Module/imu/mpu6050.c ****   res=MPU_Read_Byte(MPU_DEVICE_ID_REG);
 802              		.loc 1 26 3 view .LVU186
 803 0042 8021     		movs	r1, #128
 804 0044 3720     		movs	r0, #55
 805 0046 FFF7FEFF 		bl	MPU_Write_Byte
 806              	.LVL67:
  27:Module/imu/mpu6050.c **** 	printf("\r\nMPU6050:0x%2x\r\n",res);
 807              		.loc 1 27 3 view .LVU187
  27:Module/imu/mpu6050.c **** 	printf("\r\nMPU6050:0x%2x\r\n",res);
 808              		.loc 1 27 7 is_stmt 0 view .LVU188
 809 004a 7520     		movs	r0, #117
 810 004c FFF7FEFF 		bl	MPU_Read_Byte
 811              	.LVL68:
 812 0050 0446     		mov	r4, r0
 813              	.LVL69:
  28:Module/imu/mpu6050.c ****   if(res==MPU_ADDR)//器件ID正确
 814              		.loc 1 28 2 is_stmt 1 view .LVU189
 815 0052 0146     		mov	r1, r0
 816 0054 0A48     		ldr	r0, .L49+4
 817              	.LVL70:
  28:Module/imu/mpu6050.c ****   if(res==MPU_ADDR)//器件ID正确
 818              		.loc 1 28 2 is_stmt 0 view .LVU190
 819 0056 FFF7FEFF 		bl	printf
 820              	.LVL71:
  29:Module/imu/mpu6050.c ****   {
 821              		.loc 1 29 3 is_stmt 1 view .LVU191
  29:Module/imu/mpu6050.c ****   {
 822              		.loc 1 29 5 is_stmt 0 view .LVU192
 823 005a 682C     		cmp	r4, #104
 824 005c 01D0     		beq	.L48
  35:Module/imu/mpu6050.c **** 
ARM GAS  /tmp/cc4TUbDM.s 			page 21


 825              		.loc 1 35 10 view .LVU193
 826 005e 0120     		movs	r0, #1
 827              	.L45:
  39:Module/imu/mpu6050.c **** //设置MPU6050陀螺仪传感器满量程范围
 828              		.loc 1 39 1 view .LVU194
 829 0060 10BD     		pop	{r4, pc}
 830              	.L48:
  31:Module/imu/mpu6050.c ****     MPU_Write_Byte(MPU_PWR_MGMT2_REG,0X00);	//加速度与陀螺仪都工作
 831              		.loc 1 31 5 is_stmt 1 view .LVU195
 832 0062 0121     		movs	r1, #1
 833 0064 6B20     		movs	r0, #107
 834 0066 FFF7FEFF 		bl	MPU_Write_Byte
 835              	.LVL72:
  32:Module/imu/mpu6050.c ****     MPU_Set_Rate(50);						//设置采样率为50Hz
 836              		.loc 1 32 5 view .LVU196
 837 006a 0021     		movs	r1, #0
 838 006c 6C20     		movs	r0, #108
 839 006e FFF7FEFF 		bl	MPU_Write_Byte
 840              	.LVL73:
  33:Module/imu/mpu6050.c ****   }else 
 841              		.loc 1 33 5 view .LVU197
 842 0072 3220     		movs	r0, #50
 843 0074 FFF7FEFF 		bl	MPU_Set_Rate
 844              	.LVL74:
  38:Module/imu/mpu6050.c **** }
 845              		.loc 1 38 3 view .LVU198
  38:Module/imu/mpu6050.c **** }
 846              		.loc 1 38 10 is_stmt 0 view .LVU199
 847 0078 0020     		movs	r0, #0
 848 007a F1E7     		b	.L45
 849              	.L50:
 850              		.align	2
 851              	.L49:
 852 007c 00000000 		.word	hi2c1
 853 0080 00000000 		.word	.LC0
 854              		.cfi_endproc
 855              	.LFE135:
 857              		.section	.text.MpuGetData,"ax",%progbits
 858              		.align	1
 859              		.global	MpuGetData
 860              		.syntax unified
 861              		.thumb
 862              		.thumb_func
 864              	MpuGetData:
 865              	.LFB147:
 186:Module/imu/mpu6050.c **** 
 187:Module/imu/mpu6050.c **** /* 读取MPU6050数据并加滤波 */
 188:Module/imu/mpu6050.c **** void MpuGetData(void)
 189:Module/imu/mpu6050.c **** {
 866              		.loc 1 189 1 is_stmt 1 view -0
 867              		.cfi_startproc
 868              		@ args = 0, pretend = 0, frame = 16
 869              		@ frame_needed = 0, uses_anonymous_args = 0
 870 0000 70B5     		push	{r4, r5, r6, lr}
 871              	.LCFI26:
 872              		.cfi_def_cfa_offset 16
 873              		.cfi_offset 4, -16
ARM GAS  /tmp/cc4TUbDM.s 			page 22


 874              		.cfi_offset 5, -12
 875              		.cfi_offset 6, -8
 876              		.cfi_offset 14, -4
 877 0002 88B0     		sub	sp, sp, #32
 878              	.LCFI27:
 879              		.cfi_def_cfa_offset 48
 190:Module/imu/mpu6050.c **** 	uint8_t i;
 880              		.loc 1 190 2 view .LVU201
 191:Module/imu/mpu6050.c ****   uint8_t buffer[12];
 881              		.loc 1 191 3 view .LVU202
 192:Module/imu/mpu6050.c **** 	
 193:Module/imu/mpu6050.c **** 	HAL_I2C_Mem_Read(&hi2c1, MPU_READ, 0X3B, I2C_MEMADD_SIZE_8BIT, buffer, 6, 0xfff);				/* 读取角
 882              		.loc 1 193 2 view .LVU203
 883 0004 3A4C     		ldr	r4, .L58
 884 0006 40F6FF76 		movw	r6, #4095
 885 000a 0296     		str	r6, [sp, #8]
 886 000c 0625     		movs	r5, #6
 887 000e 0195     		str	r5, [sp, #4]
 888 0010 05AB     		add	r3, sp, #20
 889 0012 0093     		str	r3, [sp]
 890 0014 0123     		movs	r3, #1
 891 0016 3B22     		movs	r2, #59
 892 0018 D121     		movs	r1, #209
 893 001a 2046     		mov	r0, r4
 894 001c FFF7FEFF 		bl	HAL_I2C_Mem_Read
 895              	.LVL75:
 194:Module/imu/mpu6050.c **** 	HAL_I2C_Mem_Read(&hi2c1, MPU_READ, 0x43, I2C_MEMADD_SIZE_8BIT, &buffer[6], 6, 0xfff);		/* 读取
 896              		.loc 1 194 2 view .LVU204
 897 0020 0296     		str	r6, [sp, #8]
 898 0022 0195     		str	r5, [sp, #4]
 899 0024 0DF11A03 		add	r3, sp, #26
 900 0028 0093     		str	r3, [sp]
 901 002a 0123     		movs	r3, #1
 902 002c 4322     		movs	r2, #67
 903 002e D121     		movs	r1, #209
 904 0030 2046     		mov	r0, r4
 905 0032 FFF7FEFF 		bl	HAL_I2C_Mem_Read
 906              	.LVL76:
 195:Module/imu/mpu6050.c **** 
 196:Module/imu/mpu6050.c **** //	printf("buff:%d\r\n",buffer[1]);
 197:Module/imu/mpu6050.c **** 	
 198:Module/imu/mpu6050.c **** 	for(i=0;i<6;i++)
 907              		.loc 1 198 2 view .LVU205
 908              		.loc 1 198 7 is_stmt 0 view .LVU206
 909 0036 0024     		movs	r4, #0
 910              		.loc 1 198 2 view .LVU207
 911 0038 1DE0     		b	.L52
 912              	.LVL77:
 913              	.L53:
 914              	.LBB2:
 199:Module/imu/mpu6050.c **** 	{
 200:Module/imu/mpu6050.c **** 		pMpu[i] = (((int16_t)buffer[i<<1] << 8) | buffer[(i<<1)+1])-MpuOffset[i];							/* 将数据整
 201:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 202:Module/imu/mpu6050.c **** 		{
 203:Module/imu/mpu6050.c **** 			{
 204:Module/imu/mpu6050.c **** 				static struct KalmanFilter EKF[3] = {{0.02,0,0,0,0.001,0.543},{0.02,0,0,0,0.001,0.543},{0.02,0,
 915              		.loc 1 204 5 is_stmt 1 view .LVU208
ARM GAS  /tmp/cc4TUbDM.s 			page 23


 205:Module/imu/mpu6050.c **** 				kalmanfiter(&EKF[i],(float)pMpu[i]);  
 916              		.loc 1 205 5 view .LVU209
 917              		.loc 1 205 36 is_stmt 0 view .LVU210
 918 003a 32F81430 		ldrh	r3, [r2, r4, lsl #1]
 919 003e 1BB2     		sxth	r3, r3
 920 0040 00EE103A 		vmov	s0, r3	@ int
 921              		.loc 1 205 5 view .LVU211
 922 0044 6500     		lsls	r5, r4, #1
 923 0046 04EB4402 		add	r2, r4, r4, lsl #1
 924 004a D000     		lsls	r0, r2, #3
 925 004c 294E     		ldr	r6, .L58+4
 926 004e B8EEC00A 		vcvt.f32.s32	s0, s0
 927 0052 3044     		add	r0, r0, r6
 928 0054 FFF7FEFF 		bl	kalmanfiter
 929              	.LVL78:
 206:Module/imu/mpu6050.c **** 				pMpu[i] = (int16_t)EKF[i].Out;
 930              		.loc 1 206 5 is_stmt 1 view .LVU212
 931              		.loc 1 206 30 is_stmt 0 view .LVU213
 932 0058 2B19     		adds	r3, r5, r4
 933 005a DA00     		lsls	r2, r3, #3
 934 005c 1644     		add	r6, r6, r2
 935 005e D6ED027A 		vldr.32	s15, [r6, #8]
 936              		.loc 1 206 15 view .LVU214
 937 0062 FDEEE77A 		vcvt.s32.f32	s15, s15
 938 0066 17EE903A 		vmov	r3, s15	@ int
 939 006a 1BB2     		sxth	r3, r3
 940              		.loc 1 206 13 view .LVU215
 941 006c 224A     		ldr	r2, .L58+8
 942 006e 22F81430 		strh	r3, [r2, r4, lsl #1]	@ movhi
 943              	.LBE2:
 207:Module/imu/mpu6050.c **** //				printf("EKF:%f\r\n",EKF[i].Out);
 208:Module/imu/mpu6050.c **** 			}
 209:Module/imu/mpu6050.c **** 		}
 210:Module/imu/mpu6050.c **** 		if(i > 2)		/* 角速度一阶互补滤波 */
 944              		.loc 1 210 3 is_stmt 1 view .LVU216
 945              	.L54:
 198:Module/imu/mpu6050.c **** 	{
 946              		.loc 1 198 15 discriminator 2 view .LVU217
 947 0072 0134     		adds	r4, r4, #1
 948              	.LVL79:
 198:Module/imu/mpu6050.c **** 	{
 949              		.loc 1 198 15 is_stmt 0 discriminator 2 view .LVU218
 950 0074 E4B2     		uxtb	r4, r4
 951              	.LVL80:
 952              	.L52:
 198:Module/imu/mpu6050.c **** 	{
 953              		.loc 1 198 11 is_stmt 1 discriminator 1 view .LVU219
 954 0076 052C     		cmp	r4, #5
 955 0078 37D8     		bhi	.L57
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 956              		.loc 1 200 3 view .LVU220
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 957              		.loc 1 200 32 is_stmt 0 view .LVU221
 958 007a 6300     		lsls	r3, r4, #1
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 959              		.loc 1 200 30 view .LVU222
 960 007c 08AA     		add	r2, sp, #32
ARM GAS  /tmp/cc4TUbDM.s 			page 24


 961 007e 02EB4402 		add	r2, r2, r4, lsl #1
 962 0082 12F80C2C 		ldrb	r2, [r2, #-12]	@ zero_extendqisi2
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 963              		.loc 1 200 51 view .LVU223
 964 0086 2133     		adds	r3, r3, #33
 965 0088 6B44     		add	r3, sp, r3
 966 008a 13F80C3C 		ldrb	r3, [r3, #-12]	@ zero_extendqisi2
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 967              		.loc 1 200 43 view .LVU224
 968 008e 43EA0223 		orr	r3, r3, r2, lsl #8
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 969              		.loc 1 200 72 view .LVU225
 970 0092 1A4A     		ldr	r2, .L58+12
 971 0094 32F81410 		ldrh	r1, [r2, r4, lsl #1]
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 972              		.loc 1 200 7 view .LVU226
 973 0098 174A     		ldr	r2, .L58+8
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 974              		.loc 1 200 62 view .LVU227
 975 009a 5B1A     		subs	r3, r3, r1
 976 009c 1BB2     		sxth	r3, r3
 200:Module/imu/mpu6050.c **** 		if(i < 3)		/* 角加速度卡尔曼滤波 */
 977              		.loc 1 200 11 view .LVU228
 978 009e 22F81430 		strh	r3, [r2, r4, lsl #1]	@ movhi
 201:Module/imu/mpu6050.c **** 		{
 979              		.loc 1 201 3 is_stmt 1 view .LVU229
 201:Module/imu/mpu6050.c **** 		{
 980              		.loc 1 201 5 is_stmt 0 view .LVU230
 981 00a2 022C     		cmp	r4, #2
 982 00a4 C9D9     		bls	.L53
 983              		.loc 1 210 3 is_stmt 1 view .LVU231
 984              	.LBB3:
 211:Module/imu/mpu6050.c **** 		{	
 212:Module/imu/mpu6050.c **** 			uint8_t k=i-3;
 985              		.loc 1 212 4 view .LVU232
 986              		.loc 1 212 12 is_stmt 0 view .LVU233
 987 00a6 E31E     		subs	r3, r4, #3
 988 00a8 DBB2     		uxtb	r3, r3
 989              	.LVL81:
 213:Module/imu/mpu6050.c **** 			const float factor = 0.15f;  	
 990              		.loc 1 213 4 is_stmt 1 view .LVU234
 214:Module/imu/mpu6050.c **** 			static float tBuff[3];		
 991              		.loc 1 214 4 view .LVU235
 215:Module/imu/mpu6050.c **** 
 216:Module/imu/mpu6050.c **** 			pMpu[i] = tBuff[k] = tBuff[k] * (1 - factor) + pMpu[i] * factor;                
 992              		.loc 1 216 4 view .LVU236
 993              		.loc 1 216 30 is_stmt 0 view .LVU237
 994 00aa 1549     		ldr	r1, .L58+16
 995 00ac 01EB8301 		add	r1, r1, r3, lsl #2
 996 00b0 D1ED007A 		vldr.32	s15, [r1]
 997              		.loc 1 216 34 view .LVU238
 998 00b4 9FED137A 		vldr.32	s14, .L58+20
 999 00b8 67EE877A 		vmul.f32	s15, s15, s14
 1000              		.loc 1 216 55 view .LVU239
 1001 00bc 32F81430 		ldrh	r3, [r2, r4, lsl #1]
 1002              	.LVL82:
 1003              		.loc 1 216 55 view .LVU240
ARM GAS  /tmp/cc4TUbDM.s 			page 25


 1004 00c0 1BB2     		sxth	r3, r3
 1005 00c2 07EE103A 		vmov	s14, r3	@ int
 1006              		.loc 1 216 59 view .LVU241
 1007 00c6 B8EEC77A 		vcvt.f32.s32	s14, s14
 1008 00ca DFED0F6A 		vldr.32	s13, .L58+24
 1009 00ce 27EE267A 		vmul.f32	s14, s14, s13
 1010              		.loc 1 216 49 view .LVU242
 1011 00d2 77EE877A 		vadd.f32	s15, s15, s14
 1012              		.loc 1 216 23 view .LVU243
 1013 00d6 C1ED007A 		vstr.32	s15, [r1]
 1014              		.loc 1 216 12 view .LVU244
 1015 00da FDEEE77A 		vcvt.s32.f32	s15, s15
 1016 00de 17EE903A 		vmov	r3, s15	@ int
 1017 00e2 1BB2     		sxth	r3, r3
 1018 00e4 22F81430 		strh	r3, [r2, r4, lsl #1]	@ movhi
 1019 00e8 C3E7     		b	.L54
 1020              	.LVL83:
 1021              	.L57:
 1022              		.loc 1 216 12 view .LVU245
 1023              	.LBE3:
 217:Module/imu/mpu6050.c **** 		}
 218:Module/imu/mpu6050.c **** 	}	
 219:Module/imu/mpu6050.c **** }...
 1024              		.loc 1 219 1 view .LVU246
 1025 00ea 08B0     		add	sp, sp, #32
 1026              	.LCFI28:
 1027              		.cfi_def_cfa_offset 16
 1028              		@ sp needed
 1029 00ec 70BD     		pop	{r4, r5, r6, pc}
 1030              	.LVL84:
 1031              	.L59:
 1032              		.loc 1 219 1 view .LVU247
 1033 00ee 00BF     		.align	2
 1034              	.L58:
 1035 00f0 00000000 		.word	hi2c1
 1036 00f4 00000000 		.word	EKF.1
 1037 00f8 00000000 		.word	MPU6050
 1038 00fc 00000000 		.word	MpuOffset
 1039 0100 00000000 		.word	tBuff.0
 1040 0104 9A99593F 		.word	1062836634
 1041 0108 9A99193E 		.word	1041865114
 1042              		.cfi_endproc
 1043              	.LFE147:
 1045              		.section	.bss.tBuff.0,"aw",%nobits
 1046              		.align	2
 1049              	tBuff.0:
 1050 0000 00000000 		.space	12
 1050      00000000 
 1050      00000000 
 1051              		.section	.data.EKF.1,"aw"
 1052              		.align	2
 1055              	EKF.1:
 1056 0000 0AD7A33C 		.word	1017370378
 1057 0004 00000000 		.word	0
 1058 0008 00000000 		.word	0
 1059 000c 00000000 		.word	0
 1060 0010 6F12833A 		.word	981668463
ARM GAS  /tmp/cc4TUbDM.s 			page 26


 1061 0014 0C020B3F 		.word	1057686028
 1062 0018 0AD7A33C 		.word	1017370378
 1063 001c 00000000 		.word	0
 1064 0020 00000000 		.word	0
 1065 0024 00000000 		.word	0
 1066 0028 6F12833A 		.word	981668463
 1067 002c 0C020B3F 		.word	1057686028
 1068 0030 0AD7A33C 		.word	1017370378
 1069 0034 00000000 		.word	0
 1070 0038 00000000 		.word	0
 1071 003c 00000000 		.word	0
 1072 0040 6F12833A 		.word	981668463
 1073 0044 0C020B3F 		.word	1057686028
 1074              		.global	MpuOffset
 1075              		.section	.bss.MpuOffset,"aw",%nobits
 1076              		.align	2
 1079              	MpuOffset:
 1080 0000 00000000 		.space	12
 1080      00000000 
 1080      00000000 
 1081              		.text
 1082              	.Letext0:
 1083              		.file 2 "/home/yml/mondrian/arm-gnu-toolchain-13.2.Rel1-x86_64-arm-none-eabi/arm-none-eabi/include
 1084              		.file 3 "/home/yml/mondrian/arm-gnu-toolchain-13.2.Rel1-x86_64-arm-none-eabi/arm-none-eabi/include
 1085              		.file 4 "Drivers/CMSIS/Device/ST/STM32G4xx/Include/stm32g474xx.h"
 1086              		.file 5 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_def.h"
 1087              		.file 6 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_dma.h"
 1088              		.file 7 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal_i2c.h"
 1089              		.file 8 "Module/imu/alldata.h"
 1090              		.file 9 "Module/kalman/kalman.h"
 1091              		.file 10 "Core/Inc/i2c.h"
 1092              		.file 11 "Drivers/STM32G4xx_HAL_Driver/Inc/stm32g4xx_hal.h"
 1093              		.file 12 "/home/yml/mondrian/arm-gnu-toolchain-13.2.Rel1-x86_64-arm-none-eabi/arm-none-eabi/includ
ARM GAS  /tmp/cc4TUbDM.s 			page 27


DEFINED SYMBOLS
                            *ABS*:00000000 mpu6050.c
     /tmp/cc4TUbDM.s:21     .text.MPU_Write_Len:00000000 $t
     /tmp/cc4TUbDM.s:27     .text.MPU_Write_Len:00000000 MPU_Write_Len
     /tmp/cc4TUbDM.s:75     .text.MPU_Write_Len:00000028 $d
     /tmp/cc4TUbDM.s:80     .text.MPU_Read_Len:00000000 $t
     /tmp/cc4TUbDM.s:86     .text.MPU_Read_Len:00000000 MPU_Read_Len
     /tmp/cc4TUbDM.s:134    .text.MPU_Read_Len:00000028 $d
     /tmp/cc4TUbDM.s:144    .text.MPU_Get_Temperature:00000000 $t
     /tmp/cc4TUbDM.s:150    .text.MPU_Get_Temperature:00000000 MPU_Get_Temperature
     /tmp/cc4TUbDM.s:220    .text.MPU_Get_Temperature:00000050 $d
     /tmp/cc4TUbDM.s:229    .text.MPU_Get_Gyroscope:00000000 $t
     /tmp/cc4TUbDM.s:235    .text.MPU_Get_Gyroscope:00000000 MPU_Get_Gyroscope
     /tmp/cc4TUbDM.s:313    .text.MPU_Get_Accelerometer:00000000 $t
     /tmp/cc4TUbDM.s:319    .text.MPU_Get_Accelerometer:00000000 MPU_Get_Accelerometer
     /tmp/cc4TUbDM.s:398    .text.MPU_Write_Byte:00000000 $t
     /tmp/cc4TUbDM.s:404    .text.MPU_Write_Byte:00000000 MPU_Write_Byte
     /tmp/cc4TUbDM.s:461    .text.MPU_Write_Byte:00000034 $d
     /tmp/cc4TUbDM.s:466    .text.MPU_Set_Gyro_Fsr:00000000 $t
     /tmp/cc4TUbDM.s:472    .text.MPU_Set_Gyro_Fsr:00000000 MPU_Set_Gyro_Fsr
     /tmp/cc4TUbDM.s:500    .text.MPU_Set_Accel_Fsr:00000000 $t
     /tmp/cc4TUbDM.s:506    .text.MPU_Set_Accel_Fsr:00000000 MPU_Set_Accel_Fsr
     /tmp/cc4TUbDM.s:534    .text.MPU_Set_LPF:00000000 $t
     /tmp/cc4TUbDM.s:540    .text.MPU_Set_LPF:00000000 MPU_Set_LPF
     /tmp/cc4TUbDM.s:613    .text.MPU_Set_Rate:00000000 $t
     /tmp/cc4TUbDM.s:619    .text.MPU_Set_Rate:00000000 MPU_Set_Rate
     /tmp/cc4TUbDM.s:678    .text.MPU_Read_Byte:00000000 $t
     /tmp/cc4TUbDM.s:684    .text.MPU_Read_Byte:00000000 MPU_Read_Byte
     /tmp/cc4TUbDM.s:733    .text.MPU_Read_Byte:00000034 $d
     /tmp/cc4TUbDM.s:738    .rodata.MPU_Init.str1.4:00000000 $d
     /tmp/cc4TUbDM.s:742    .text.MPU_Init:00000000 $t
     /tmp/cc4TUbDM.s:748    .text.MPU_Init:00000000 MPU_Init
     /tmp/cc4TUbDM.s:852    .text.MPU_Init:0000007c $d
     /tmp/cc4TUbDM.s:858    .text.MpuGetData:00000000 $t
     /tmp/cc4TUbDM.s:864    .text.MpuGetData:00000000 MpuGetData
     /tmp/cc4TUbDM.s:1035   .text.MpuGetData:000000f0 $d
     /tmp/cc4TUbDM.s:1055   .data.EKF.1:00000000 EKF.1
     /tmp/cc4TUbDM.s:1079   .bss.MpuOffset:00000000 MpuOffset
     /tmp/cc4TUbDM.s:1049   .bss.tBuff.0:00000000 tBuff.0
     /tmp/cc4TUbDM.s:1046   .bss.tBuff.0:00000000 $d
     /tmp/cc4TUbDM.s:1052   .data.EKF.1:00000000 $d
     /tmp/cc4TUbDM.s:1076   .bss.MpuOffset:00000000 $d

UNDEFINED SYMBOLS
HAL_I2C_Mem_Write
HAL_Delay
hi2c1
HAL_I2C_Mem_Read
__aeabi_i2d
__aeabi_ddiv
__aeabi_dadd
__aeabi_dmul
__aeabi_d2f
HAL_I2C_Init
printf
kalmanfiter
MPU6050
ARM GAS  /tmp/cc4TUbDM.s 			page 28


